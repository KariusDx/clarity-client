<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.6 at 2015-06-03 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>CRUK-CI Genologics API Client &#x2013; </title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20150603" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                CRUK-CI Genologics API Client
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2015-06-03</span>
                  &nbsp;| <span id="projectVersion">Version: 2.21</span>
                      </div>
            <div class="xright">        
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>User Guide</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="installing.html" title="Installation">Installation</a>
            </li>
                                                                                                                              <li class="expanded">
                          <a href="usageoverview.html" title="Usage">Usage</a>
                    <ul>
                      <li class="none">
                          <a href="spring.html" title="Spring Configuration">Spring Configuration</a>
            </li>
                      <li class="none">
                          <a href="usage.html" title="Basic Usage">Basic Usage</a>
            </li>
                      <li class="none">
            <strong>Caching</strong>
          </li>
                      <li class="none">
                          <a href="serverside.html" title="Server Deployment">Server Deployment</a>
            </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="issues.html" title="Known Issues">Known Issues</a>
            </li>
                  <li class="none">
                          <a href="references.html" title="Reference Documentation">Reference Documentation</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2><a name="Caching"></a>Caching</h2>
<p>Using the in-memory cache with the client can <b>massively</b> increase the speed a script can run. It accumulates a number of entities from REST API calls so subsequent calls to retrieve these same entities need not pass through to the API. This also has the effect to simplifying user code, as the script can make the calls through the <tt><a href="./apidocs/org/cruk/genologics/api/GenologicsAPI.html">GenologicsAPI</a></tt> interface without worrying about whether it already has some or all of the objects requested.</p>
<p>Like any client side caching, there are risks that an entity will be updated from elsewhere while the client holds an earlier copy of the object. This hasn't presented us much of a problem in EPP scripts (where this client is used a lot) as these run from beginning to end and then stop, so the lifetime of the cache is simply the duration of the script.</p>
<p>If used in a server environment, the cache can still be beneficial but it may need to be tweaked so objects don't live as long in the cache. We've found that most operations rarely hit the same objects from two different people (though this is a risk) and the performance gain much outweighs the risk of out of date information. The cache can be tuned or disabled as required by the application.</p>
<div class="section">
<h3><a name="Enabling_the_cache"></a>Enabling the cache</h3>
<p>The cache is essentially an aspect around the main <tt>GenologicsAPI</tt> implementation. It is configured with Spring and can be enabled for an application by adding a file to Spring's application context path:</p>
<div class="source">
<pre>/org/cruk/genologics/api/genologics-cache-context.xml</pre></div>
<p>This configuration does require the general <tt>/org/cruk/genologics/api/genologics-client-context.xml</tt> configuration to be in Spring's application context path as it depends on beans defined there.</p>
<p><tt>genologics-cache-context.xml</tt> is provided in the client's JAR file.</p></div>
<div class="section">
<h3><a name="Tuning_the_cache"></a>Tuning the cache</h3>
<p>The cache is controlled by the file:</p>
<div class="source">
<pre>/org/cruk/genologics/api/ehcache.xml</pre></div>
<p>This file is also provided in the client's JAR file. It provides caches for different entities that can be individually tuned for each class in the API. Any class that does not have a specific cache defined goes into the catch-all cache <i>com.genologics.ri.LimsEntity</i>.</p>
<p>If you do need to change the cache configuration, make a new <tt>org/cruk/genologics/api/ehcache.xml</tt> that appears in a folder or JAR before the client's JAR file in the class path.</p></div>
<div class="section">
<h3><a name="Artifacts_and_their_state_parameter"></a>Artifacts and their state parameter</h3>
<p>The <tt>Artifact</tt> class provides some complication to the cache by always having a <i>state</i> parameter attached to its URIs. This means a given artifact can be returned in different states depending on the state in the URI. At present, the cache keeps the latest version of the Artifact currently requested. If a request is made for the same Artifact but of an earlier state, the cached version of the Artifact is returned, despite the fact that the state may not be the same. If a later version is requested to that in the cache, a fetch is made and the retrieved version replaces that in the cache.</p>
<p>A future refinement to the client API cache may be to offer different strategies for handling Artifacts. The current implementation is one; exact matches of state only and ignoring state altogether are two that may be more suitable to certain applications.</p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2013&#x2013;2015
                        <a href="http://www.cruk.cam.ac.uk">Cancer Research UK Cambridge Institute</a>.
            All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
